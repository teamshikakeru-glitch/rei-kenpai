<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rei ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; background: #1a1f2e; color: #e0e0e0; line-height: 1.6; min-height: 100vh; }
    
    /* ãƒ­ã‚°ã‚¤ãƒ³ */
    .login-screen {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #1a1f2e 0%, #2d3548 100%);
    }
    .login-card {
      background: #252b3d;
      border-radius: 16px;
      padding: 2.5rem;
      width: 90%;
      max-width: 400px;
      text-align: center;
    }
    .login-logo { font-size: 3rem; color: #c9a962; margin-bottom: 1rem; }
    .login-title { font-size: 1.3rem; font-weight: 600; margin-bottom: 0.5rem; }
    .login-sub { font-size: 0.9rem; color: #8a8a9a; margin-bottom: 1.5rem; }
    .form-input {
      width: 100%;
      padding: 0.9rem 1rem;
      font-size: 1rem;
      border: 2px solid #3d4559;
      border-radius: 8px;
      background: #1a1f2e;
      color: white;
      margin-bottom: 1rem;
    }
    .form-input:focus { outline: none; border-color: #c9a962; }
    .btn {
      display: block;
      width: 100%;
      padding: 0.9rem;
      font-size: 1rem;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .btn-gold { background: #c9a962; color: #1a1f2e; }
    .btn-gold:hover { background: #d4b978; }
    .error-box { background: #5c2a2a; color: #ff8a8a; padding: 0.75rem; border-radius: 8px; margin-bottom: 1rem; font-size: 0.85rem; display: none; }
    
    /* ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ */
    .main-menu {
      display: none;
      min-height: 100vh;
      padding: 2rem;
      max-width: 900px;
      margin: 0 auto;
    }
    .menu-header {
      text-align: center;
      margin-bottom: 2rem;
    }
    .menu-logo {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
    }
    .menu-title {
      font-size: 1.1rem;
      color: #8a8a9a;
    }
    
    /* å—æ³¨æ•°ã‚«ãƒ¼ãƒ‰ */
    .stats-card {
      background: linear-gradient(135deg, #c9a962 0%, #d4b978 100%);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      text-align: center;
      color: #1a1f2e;
    }
    .stats-number {
      font-size: 4rem;
      font-weight: 700;
      line-height: 1;
      margin-bottom: 0.25rem;
    }
    .stats-label {
      font-size: 1.1rem;
      font-weight: 600;
      opacity: 0.9;
    }
    .stats-sub {
      font-size: 0.85rem;
      opacity: 0.7;
      margin-top: 0.5rem;
    }
    .stats-loading {
      font-size: 1.5rem;
      padding: 1rem 0;
    }
    
    .menu-section {
      margin-bottom: 1.5rem;
    }
    .menu-section-title {
      font-size: 0.85rem;
      color: #8a8a9a;
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .menu-card {
      background: #252b3d;
      border-radius: 12px;
      overflow: hidden;
    }
    .menu-item {
      display: flex;
      align-items: center;
      padding: 1rem 1.25rem;
      border-bottom: 1px solid #3d4559;
      text-decoration: none;
      color: inherit;
      cursor: pointer;
      transition: background 0.2s;
    }
    .menu-item:last-child { border-bottom: none; }
    .menu-item:hover { background: #2d3548; }
    .menu-item-icon {
      width: 44px;
      height: 44px;
      border-radius: 10px;
      background: #3d4559;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
      margin-right: 1rem;
    }
    .menu-item-content { flex: 1; }
    .menu-item-title { font-weight: 600; font-size: 1rem; }
    .menu-item-desc { font-size: 0.8rem; color: #8a8a9a; }
    .menu-item-arrow { color: #8a8a9a; font-size: 1.2rem; }
    
    /* URLå…±æœ‰ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
    .url-section {
      background: #252b3d;
      border-radius: 12px;
      padding: 1.25rem;
      margin-bottom: 1.5rem;
    }
    .url-section-title {
      font-size: 0.95rem;
      font-weight: 600;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .url-group {
      margin-bottom: 1rem;
    }
    .url-group:last-child { margin-bottom: 0; }
    .url-label {
      font-size: 0.8rem;
      color: #8a8a9a;
      margin-bottom: 0.4rem;
    }
    .url-row {
      display: flex;
      gap: 0.5rem;
    }
    .url-input {
      flex: 1;
      padding: 0.7rem 1rem;
      background: #1a1f2e;
      border: 1px solid #3d4559;
      border-radius: 8px;
      color: #e0e0e0;
      font-size: 0.85rem;
    }
    .url-copy {
      padding: 0.7rem 1rem;
      background: #c9a962;
      color: #1a1f2e;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
    }
    .url-copy:hover { background: #d4b978; }
    
    /* æ³¨æ„æ›¸ã */
    .notice-section {
      background: #252b3d;
      border-radius: 12px;
      padding: 1.25rem;
    }
    .notice-title {
      font-size: 0.95rem;
      font-weight: 600;
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .notice-text {
      font-size: 0.85rem;
      color: #8a8a9a;
      line-height: 1.6;
    }
    
    .footer {
      text-align: center;
      padding: 2rem;
      color: #5a5a6a;
      font-size: 0.8rem;
    }
  </style>
</head>
<body>

<!-- ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ -->
<div class="login-screen" id="loginScreen">
  <div class="login-card">
    <div class="login-logo">ç¤¼</div>
    <div class="login-title">ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</div>
    <div class="login-sub">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>
    <div class="error-box" id="loginError">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™</div>
    <input type="password" class="form-input" id="adminPass" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰">
    <button class="btn btn-gold" onclick="doLogin()">ãƒ­ã‚°ã‚¤ãƒ³</button>
  </div>
</div>

<!-- ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
<div class="main-menu" id="mainMenu">
  <div class="menu-header">
    <div class="menu-title">Reiå–¶æ¥­æ”¯æ´ãƒ„ãƒ¼ãƒ«ã®ç®¡ç†ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§ã™</div>
  </div>

  <!-- å—æ³¨æ•°ã‚«ãƒ¼ãƒ‰ -->
  <div class="stats-card" id="statsCard">
    <div class="stats-loading">èª­ã¿è¾¼ã¿ä¸­...</div>
  </div>

  <!-- ç®¡ç†æ©Ÿèƒ½ -->
  <div class="menu-section">
    <div class="menu-section-title">ğŸ“Š ç®¡ç†æ©Ÿèƒ½</div>
    <div class="menu-card">
      <a class="menu-item" href="sales-test-admin.html">
        <div class="menu-item-icon">ğŸ“‹</div>
        <div class="menu-item-content">
          <div class="menu-item-title">ãƒ†ã‚¹ãƒˆçµæœç®¡ç†</div>
          <div class="menu-item-desc">å—é¨“è€…ä¸€è¦§ã¨åˆæ ¼è€…ã®ç¢ºèª</div>
        </div>
        <div class="menu-item-arrow">â†’</div>
      </a>
      <a class="menu-item" href="admin">
        <div class="menu-item-icon">ğŸ›ï¸</div>
        <div class="menu-item-content">
          <div class="menu-item-title">çŒ®æ¯ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </div>
          <div class="menu-item-desc">è‘¬å„€ç¤¾å‘ã‘ç®¡ç†ç”»é¢ã‚’é–‹ã</div>
        </div>
        <div class="menu-item-arrow">â†’</div>
      </a>
      <a class="menu-item" href="sales-admin.html">
        <div class="menu-item-icon">ğŸ‘¥</div>
        <div class="menu-item-content">
          <div class="menu-item-title">å–¶æ¥­ãƒãƒ¼ã‚¿ãƒ«ç®¡ç†</div>
          <div class="menu-item-desc">çµŒè²»æ‰¿èªãƒ»TODOæŒ‡ç¤ºãƒ»ãƒ¡ãƒ³ãƒãƒ¼ç®¡ç†</div>
        </div>
        <div class="menu-item-arrow">â†’</div>
      </a>
    </div>
  </div>

  <!-- å–¶æ¥­ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼å‘ã‘ -->
  <div class="menu-section">
    <div class="menu-section-title">ğŸ‘¤ å–¶æ¥­ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼å‘ã‘</div>
    <div class="menu-card">
      <a class="menu-item" href="how-to-start.html">
        <div class="menu-item-icon">ğŸš€</div>
        <div class="menu-item-content">
          <div class="menu-item-title">å–¶æ¥­ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã®ã”æ¡ˆå†…</div>
          <div class="menu-item-desc">ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã«ãªã‚‹ã¾ã§ã®æµã‚Œã‚’èª¬æ˜</div>
        </div>
        <div class="menu-item-arrow">â†’</div>
      </a>
      <a class="menu-item" href="system-guide.html">
        <div class="menu-item-icon">ğŸ“–</div>
        <div class="menu-item-content">
          <div class="menu-item-title">ã‚·ã‚¹ãƒ†ãƒ ãƒ»ç†å¿µè§£èª¬</div>
          <div class="menu-item-desc">Reiã®ä»•çµ„ã¿ã¨ç†å¿µã‚’å­¦ç¿’</div>
        </div>
        <div class="menu-item-arrow">â†’</div>
      </a>
      <a class="menu-item" href="sales-test.html">
        <div class="menu-item-icon">ğŸ“</div>
        <div class="menu-item-content">
          <div class="menu-item-title">å–¶æ¥­ãƒ†ã‚¹ãƒˆ</div>
          <div class="menu-item-desc">ç†è§£åº¦ã‚’ãƒ†ã‚¹ãƒˆã§ç¢ºèªï¼ˆ80ç‚¹ã§åˆæ ¼ï¼‰</div>
        </div>
        <div class="menu-item-arrow">â†’</div>
      </a>
      <a class="menu-item" href="sales-portal.html">
        <div class="menu-item-icon">ğŸ“±</div>
        <div class="menu-item-content">
          <div class="menu-item-title">å–¶æ¥­ãƒãƒ¼ã‚¿ãƒ«</div>
          <div class="menu-item-desc">è¨ªå•å…ˆç®¡ç†ãƒ»çµŒè²»ç”³è«‹ãƒ»æ²ç¤ºæ¿ãªã©</div>
        </div>
        <div class="menu-item-arrow">â†’</div>
      </a>
    </div>
  </div>

  <!-- URLå…±æœ‰ -->
  <div class="url-section">
    <div class="url-section-title">ğŸ”— ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼å€™è£œè€…ã«å…±æœ‰ã™ã‚‹URL</div>
    
    <div class="url-group">
      <div class="url-label">å–¶æ¥­ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã®ã”æ¡ˆå†…ãƒšãƒ¼ã‚¸ï¼ˆæ¨å¥¨ï¼‰</div>
      <div class="url-row">
        <input type="text" class="url-input" value="https://rei-kenpai-b3z8.vercel.app/how-to-start.html" readonly id="url1">
        <button class="url-copy" onclick="copyUrl('url1')">ã‚³ãƒ”ãƒ¼</button>
      </div>
    </div>
    
    <div class="url-group">
      <div class="url-label">ã‚·ã‚¹ãƒ†ãƒ ãƒ»ç†å¿µè§£èª¬ãƒšãƒ¼ã‚¸</div>
      <div class="url-row">
        <input type="text" class="url-input" value="https://rei-kenpai-b3z8.vercel.app/system-guide.html" readonly id="url2">
        <button class="url-copy" onclick="copyUrl('url2')">ã‚³ãƒ”ãƒ¼</button>
      </div>
    </div>
    
    <div class="url-group">
      <div class="url-label">å–¶æ¥­ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸</div>
      <div class="url-row">
        <input type="text" class="url-input" value="https://rei-kenpai-b3z8.vercel.app/sales-test.html" readonly id="url3">
        <button class="url-copy" onclick="copyUrl('url3')">ã‚³ãƒ”ãƒ¼</button>
      </div>
    </div>
    
    <div class="url-group">
      <div class="url-label">å–¶æ¥­ãƒãƒ¼ã‚¿ãƒ«</div>
      <div class="url-row">
        <input type="text" class="url-input" value="https://rei-kenpai-b3z8.vercel.app/sales-portal.html" readonly id="url4">
        <button class="url-copy" onclick="copyUrl('url4')">ã‚³ãƒ”ãƒ¼</button>
      </div>
    </div>
  </div>

  <!-- æ³¨æ„æ›¸ã -->
  <div class="notice-section">
    <div class="notice-title">ğŸ’¡ å…±æœ‰ã«ã¤ã„ã¦</div>
    <div class="notice-text">
      å–¶æ¥­ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼å€™è£œè€…ã«ã¯ã€Œå–¶æ¥­ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã®ã”æ¡ˆå†…ã€ãƒšãƒ¼ã‚¸ã®URLã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚<br><br>
      ã“ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®URLã¯ç®¡ç†è€…ã®ã¿ã«å…±æœ‰ã—ã¦ãã ã•ã„ã€‚
    </div>
  </div>

  <div class="footer">Â© 2024 Rei ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</div>
</div>

<script>
var ADMIN_PASS = '1123';

// Supabaseè¨­å®š
var SUPABASE_URL = 'https://osyysvompcfuadlnuojs.supabase.co';
var SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9zeXlzdm9tcGNmdWFkbG51b2pzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgwNjYzODQsImV4cCI6MjA4MzY0MjM4NH0.6GkJnnULLFH0Ep2q7IzkV5O4XNlpy8vDEB2GNM7b0w4';

var supabase = null;
try {
  supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
} catch(e) {
  console.error('SupabaseåˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', e);
}

// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚
window.onload = function() {
  if (localStorage.getItem('reiAdminLoggedIn') === 'true') {
    showMenu();
  }
  
  document.getElementById('adminPass').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') doLogin();
  });
};

function doLogin() {
  var pass = document.getElementById('adminPass').value;
  if (pass === ADMIN_PASS) {
    localStorage.setItem('reiAdminLoggedIn', 'true');
    showMenu();
  } else {
    document.getElementById('loginError').style.display = 'block';
  }
}

function showMenu() {
  document.getElementById('loginScreen').style.display = 'none';
  document.getElementById('mainMenu').style.display = 'block';
  loadStats();
}

// å—æ³¨æ•°ã‚’å–å¾—
async function loadStats() {
  var statsCard = document.getElementById('statsCard');
  
  try {
    if (!supabase) throw new Error('SupabaseæœªåˆæœŸåŒ–');
    
    // funeral_companies ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰å—æ³¨æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
    var { data, error, count } = await supabase
      .from('funeral_companies')
      .select('*', { count: 'exact', head: true });
    
    if (error) throw error;
    
    var orderCount = count || 0;
    
    statsCard.innerHTML = 
      '<div class="stats-number">' + orderCount + '</div>' +
      '<div class="stats-label">ä»¶ã®å—æ³¨</div>' +
      '<div class="stats-sub">å°å…¥æ¸ˆã¿è‘¬å„€ç¤¾æ•°</div>';
    
  } catch(e) {
    console.error('çµ±è¨ˆå–å¾—ã‚¨ãƒ©ãƒ¼:', e);
    // ã‚¨ãƒ©ãƒ¼æ™‚ã¯0ä»¶è¡¨ç¤º
    statsCard.innerHTML = 
      '<div class="stats-number">-</div>' +
      '<div class="stats-label">ä»¶ã®å—æ³¨</div>' +
      '<div class="stats-sub">ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼</div>';
  }
}

function copyUrl(inputId) {
  var input = document.getElementById(inputId);
  input.select();
  document.execCommand('copy');
  
  var btn = input.parentElement.querySelector('.url-copy');
  var original = btn.textContent;
  btn.textContent = 'âœ“ ã‚³ãƒ”ãƒ¼';
  setTimeout(function() {
    btn.textContent = original;
  }, 1500);
}
</script>

</body>
</html>